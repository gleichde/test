<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Neural Network Model - MISCnn wiki</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Neural Network Model";
    var mkdocs_page_input_path = "Model.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> MISCnn wiki</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../Home/">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Home/">What is MIScnn?</a>
                </li>
                <li class="">
                    
    <a class="" href="../Install/">Install</a>
                </li>
                <li class="">
                    
    <a class="" href="../Usage/">Basic Usage</a>
                </li>
                <li class="">
                    
    <a class="" href="../Tutorials/">Tutorials</a>
                </li>
                <li class="">
                    
    <a class="" href="../Examples/">Examples</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Documentation - Core</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Data-IO/">Data I/O</a>
                </li>
                <li class="">
                    
    <a class="" href="../Preprocessor/">Preprocessor</a>
                </li>
                <li class="">
                    
    <a class="" href="../Data-Augmentation/">Data Augmentation</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Neural Network Model</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#methods">Methods</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#initialization">Initialization</a></li>
        
            <li><a class="toctree-l4" href="#train">train</a></li>
        
            <li><a class="toctree-l4" href="#predict">predict</a></li>
        
            <li><a class="toctree-l4" href="#evaluate">evaluate</a></li>
        
            <li><a class="toctree-l4" href="#reset_weights">reset_weights</a></li>
        
            <li><a class="toctree-l4" href="#dump">dump</a></li>
        
            <li><a class="toctree-l4" href="#load">load</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../Validation/">Validation Techniques</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Documentation - Interfaces</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Architectures/">Architectures</a>
                </li>
                <li class="">
                    
    <a class="" href="../Metrics/">Metrics</a>
                </li>
                <li class="">
                    
    <a class="" href="../Subfunctions/">Subfunctions</a>
                </li>
                <li class="">
                    
    <a class="" href="../IO-Interfaces/">I/O Interfaces</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Documentation - Extras</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Sample/">Sample</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Other</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Contribute/">How to Contribute</a>
                </li>
                <li class="">
                    
    <a class="" href="../Credits/">Author and Contacts</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">MISCnn wiki</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation - Core &raquo;</li>
        
      
    
    <li>Neural Network Model</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>This class provides functionality for handling all model methods. This class runs the whole pipeline and uses a Preprocessor instance to obtain batches.</p>
<p>With an initialized Neural Network model instance, it is possible to run training, prediction and evaluations.</p>
<h2 id="methods">Methods</h2>
<h4 id="initialization">Initialization</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Neural_Network</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="n">architecture</span><span class="o">=</span><span class="n">Architecture</span><span class="p">(),</span>
               <span class="n">loss</span><span class="o">=</span><span class="n">tversky_loss</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">dice_soft</span><span class="p">],</span>
               <span class="n">learninig_rate</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">batch_queue_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">workers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gpu_number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Initialization function for creating a Neural Network (model) object.</p>
<p><strong>Arguments:</strong><br />
- <strong>preprocessor:</strong> Preprocessor class instance which provides the Neural Network with batches.
- <strong>architecture:</strong> Instance of a neural network model Architecture class instance. By default, a standard U-Net is used as Architecture.
- <strong>loss:</strong> The Metric function which is used as loss for training.
- <strong>metrics:</strong> List of one or multiple Metric Functions, which will be shown during training.
- <strong>learninig_rate:</strong> Learning rate in which weights of the neural network will be updated.
- <strong>batch_queue_size:</strong> The batch queue size is the number of previously prepared batches in the cache during runtime.
- <strong>workers:</strong> Number of workers/threads which preprocess batches during runtime.
- <strong>gpu_number:</strong> Number of GPUs, which will be used for training.</p>
<p><strong>Returns:</strong><br />
A Neural Network Model class object.</p>
<p><strong>Example:</strong>  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">miscnn</span><span class="o">.</span><span class="n">Neural_Network</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">=</span><span class="n">pp</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="train">train</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">train</span><span class="p">(</span><span class="n">sample_list</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</td></tr></table>

<p>Fitting function for the Neural Network model using the provided list of sample indices.</p>
<p><strong>Arguments:</strong>
- <strong>sample_list:</strong>  A list of sample indicies which will be used for training.
- <strong>epochs:</strong> Number of epochs. A single epoch is defined as one iteration through the complete data set.
- <strong>iterations:</strong> Number of iterations (batches) in a single epoch.
- <strong>callbacks:</strong> A list of Keras Callback classes for custom evaluation.</p>
<p><strong>Returns:</strong><br />
None.</p>
<p><strong>Example:</strong>  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="predict">predict</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">predict</span><span class="p">(</span><span class="n">sample_list</span><span class="p">,</span> <span class="n">direct_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Prediction function for the Neural Network model. The fitted model will predict a segmentation for the provided list of sample indices.</p>
<p><strong>Arguments:</strong>
- <strong>sample_list:</strong>  A list of sample indicies for which a segmentation prediction will be computed.
- <strong>direct_output:</strong> Boolean, whether computed predictions will be output as the return of this function or if the predictions will be saved with the save_prediction method defined in the provided Data I/O interface.</p>
<p><strong>Returns:</strong><br />
None or a list of NumPy arrays containing predictions.</p>
<p><strong>Example:</strong>  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Passing output of predictions into Data I/O interface - (intended for disk storage)</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">120</span><span class="p">])</span>

<span class="c1"># Direct output of predictions into variable (memory)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">120</span><span class="p">],</span> <span class="n">direct_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="evaluate">evaluate</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">evaluate</span><span class="p">(</span><span class="n">training_samples</span><span class="p">,</span> <span class="n">validation_samples</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
         <span class="n">iterations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[]):</span>
</pre></div>
</td></tr></table>

<p>Evaluation function for the Neural Network model using the provided lists of sample indices for training and validation. It is also possible to pass custom Callback classes in order to obtain more information.</p>
<p><strong>Arguments:</strong>
- <strong>training_samples:</strong>  A list of sample indicies which will be used for training.
- <strong>validation_samples:</strong> A list of sample indicies which will be used for validation.
- <strong>epochs:</strong> Number of epochs. A single epoch is defined as one iteration through the complete data set.
- <strong>iterations:</strong> Number of iterations (batches) in a single epoch.
- <strong>callbacks:</strong> A list of Keras Callback classes for custom evaluation.</p>
<p><strong>Returns:</strong><br />
Keras history object (gathered fitting information and evaluation results of the validation).</p>
<p><strong>Example:</strong>  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">training_samples</span><span class="o">=</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">80</span><span class="p">],</span>
                         <span class="n">validation_samples</span><span class="o">=</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">80</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span>
                         <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="reset_weights">reset_weights</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">reset_weights</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>Re-initialize weights of the neural network model.</p>
<p><strong>Arguments:</strong> None.</p>
<p><strong>Returns:</strong>  None.</p>
<p><strong>Example:</strong>  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Fit weights of model</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="c1"># Throw fitted weights away to default weights</span>
<span class="n">model</span><span class="o">.</span><span class="n">reset_weights</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="dump">dump</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">dump</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Dump neural network model and its weights to file.</p>
<p><strong>Arguments:</strong>
- <strong>file_path:</strong> Output path, at which the model will be stored.</p>
<p><strong>Returns:</strong>  None.</p>
<p><strong>Example:</strong>  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Fit weights of model</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="c1"># Save fitted model for reusability</span>
<span class="n">model</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s2">&quot;my_model.hdf5&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="load">load</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{}):</span>
</pre></div>
</td></tr></table>

<p>Load neural network model and its weights from a file. After loading, the model will be compiled.</p>
<p><strong>Arguments:</strong>
- <strong>file_path:</strong> Input path, from which the model will be loaded.
- <strong>custom_objects:</strong> Dictionary for custom objects for compiling (e.g. custom-defined metrics).</p>
<p><strong>Returns:</strong>  None.</p>
<p><strong>Example:</strong>  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Save fitted model for reusability</span>
<span class="n">model</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my_model.hdf5&quot;</span><span class="p">)</span>
<span class="c1"># Predict segmentation of some samples</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_list</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">120</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<hr />
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Validation/" class="btn btn-neutral float-right" title="Validation Techniques">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Data-Augmentation/" class="btn btn-neutral" title="Data Augmentation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  <p> <a href="/Home/">Home</a> | <a href="/Install/">Installation</a> | <a href="/Usage/">Usage</a> | <a href="/Examples/">Examples</a> | <a href="/Credits/">Contact</a></p>
  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Data-Augmentation/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Validation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
