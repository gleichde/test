<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Neural Network Model - MISCnn wiki</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Source+Sans+Pro:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Neural Network Model";
    var mkdocs_page_input_path = "Model.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <a href="">
        <div class="miscnn-logo">
          <img src="https://raw.githubusercontent.com/gleichde/gleichde.github.io/master/logo.JPG" class="miscnn-logo-img">
          
        </div>
      </a>

      <div class="wy-side-nav-search">
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Home/">What is MIScnn?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Install/">Install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Usage/">Basic Usage</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Tutorials/">Tutorials</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Examples/">Examples</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Documentation - Core</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../Data-IO/">Data I/O</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Preprocessor/">Preprocessor</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Data-Augmentation/">Data Augmentation</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Neural Network Model</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#initialization">Initialization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#train">train</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#predict">predict</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#evaluate">evaluate</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#reset_weights">reset_weights</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dump">dump</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#load">load</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Validation/">Validation Techniques</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Documentation - Interfaces</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Architectures/">Architectures</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Metrics/">Metrics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Subfunctions/">Subfunctions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../IO-Interfaces/">I/O Interfaces</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Documentation - Extras</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Sample/">Sample</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Other</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Contribute/">How to Contribute</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Credits/">Author and Contacts</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">MISCnn wiki</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation - Core &raquo;</li>
        
      
    
    <li>Neural Network Model</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/frankkramer-lab/MIScnn/"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>This class provides functionality for handling all model methods. This class runs the whole pipeline and uses a Preprocessor instance to obtain batches.</p>
<p>With an initialized Neural Network model instance, it is possible to run training, prediction and evaluations.</p>
<h2 id="methods">Methods</h2>
<h4 id="initialization">Initialization</h4>
<pre><code class="python">Neural_Network(preprocessor, architecture=Architecture(),
               loss=tversky_loss, metrics=[dice_soft],
               learninig_rate=0.0001, batch_queue_size=2,
               workers=1, gpu_number=1)
</code></pre>

<p>Initialization function for creating a Neural Network (model) object.</p>
<p><strong>Arguments:</strong><br />
- <strong>preprocessor:</strong> Preprocessor class instance which provides the Neural Network with batches.
- <strong>architecture:</strong> Instance of a neural network model Architecture class instance. By default, a standard U-Net is used as Architecture.
- <strong>loss:</strong> The Metric function which is used as loss for training.
- <strong>metrics:</strong> List of one or multiple Metric Functions, which will be shown during training.
- <strong>learninig_rate:</strong> Learning rate in which weights of the neural network will be updated.
- <strong>batch_queue_size:</strong> The batch queue size is the number of previously prepared batches in the cache during runtime.
- <strong>workers:</strong> Number of workers/threads which preprocess batches during runtime.
- <strong>gpu_number:</strong> Number of GPUs, which will be used for training.</p>
<p><strong>Returns:</strong><br />
A Neural Network Model class object.</p>
<p><strong>Example:</strong>  </p>
<pre><code class="python">model = miscnn.Neural_Network(preprocessor=pp)
model.train(sample_list[0:100], epochs=50)
</code></pre>

<hr />
<h4 id="train">train</h4>
<pre><code class="python">train(sample_list, epochs=20, iterations=None, callbacks=[])
</code></pre>

<p>Fitting function for the Neural Network model using the provided list of sample indices.</p>
<p><strong>Arguments:</strong>
- <strong>sample_list:</strong>  A list of sample indicies which will be used for training.
- <strong>epochs:</strong> Number of epochs. A single epoch is defined as one iteration through the complete data set.
- <strong>iterations:</strong> Number of iterations (batches) in a single epoch.
- <strong>callbacks:</strong> A list of Keras Callback classes for custom evaluation.</p>
<p><strong>Returns:</strong><br />
None.</p>
<p><strong>Example:</strong>  </p>
<pre><code class="python">model.train(sample_list[0:100], epochs=50)
</code></pre>

<hr />
<h4 id="predict">predict</h4>
<pre><code class="python">predict(sample_list, direct_output=False)
</code></pre>

<p>Prediction function for the Neural Network model. The fitted model will predict a segmentation for the provided list of sample indices.</p>
<p><strong>Arguments:</strong>
- <strong>sample_list:</strong>  A list of sample indicies for which a segmentation prediction will be computed.
- <strong>direct_output:</strong> Boolean, whether computed predictions will be output as the return of this function or if the predictions will be saved with the save_prediction method defined in the provided Data I/O interface.</p>
<p><strong>Returns:</strong><br />
None or a list of NumPy arrays containing predictions.</p>
<p><strong>Example:</strong>  </p>
<pre><code class="python"># Passing output of predictions into Data I/O interface - (intended for disk storage)
model.predict(sample_list[100:120])

# Direct output of predictions into variable (memory)
predictions = model.predict(sample_list[100:120], direct_output=True)
</code></pre>

<hr />
<h4 id="evaluate">evaluate</h4>
<pre><code class="python">evaluate(training_samples, validation_samples, epochs=20,
         iterations=None, callbacks=[]):
</code></pre>

<p>Evaluation function for the Neural Network model using the provided lists of sample indices for training and validation. It is also possible to pass custom Callback classes in order to obtain more information.</p>
<p><strong>Arguments:</strong>
- <strong>training_samples:</strong>  A list of sample indicies which will be used for training.
- <strong>validation_samples:</strong> A list of sample indicies which will be used for validation.
- <strong>epochs:</strong> Number of epochs. A single epoch is defined as one iteration through the complete data set.
- <strong>iterations:</strong> Number of iterations (batches) in a single epoch.
- <strong>callbacks:</strong> A list of Keras Callback classes for custom evaluation.</p>
<p><strong>Returns:</strong><br />
Keras history object (gathered fitting information and evaluation results of the validation).</p>
<p><strong>Example:</strong>  </p>
<pre><code class="python">history = model.evaluate(training_samples=sample_list[0:80],
                         validation_samples=sample_list[80:100],
                         iterations=10)
</code></pre>

<hr />
<h4 id="reset_weights">reset_weights</h4>
<pre><code class="python">reset_weights()
</code></pre>

<p>Re-initialize weights of the neural network model.</p>
<p><strong>Arguments:</strong> None.</p>
<p><strong>Returns:</strong>  None.</p>
<p><strong>Example:</strong>  </p>
<pre><code class="python"># Fit weights of model
model.train(sample_list[0:100], epochs=50)
# Throw fitted weights away to default weights
model.reset_weights()
</code></pre>

<hr />
<h4 id="dump">dump</h4>
<pre><code class="python">dump(file_path)
</code></pre>

<p>Dump neural network model and its weights to file.</p>
<p><strong>Arguments:</strong>
- <strong>file_path:</strong> Output path, at which the model will be stored.</p>
<p><strong>Returns:</strong>  None.</p>
<p><strong>Example:</strong>  </p>
<pre><code class="python"># Fit weights of model
model.train(sample_list[0:100], epochs=50)
# Save fitted model for reusability
model.dump(&quot;my_model.hdf5&quot;)
</code></pre>

<hr />
<h4 id="load">load</h4>
<pre><code class="python">load(file_path, custom_objects={}):
</code></pre>

<p>Load neural network model and its weights from a file. After loading, the model will be compiled.</p>
<p><strong>Arguments:</strong>
- <strong>file_path:</strong> Input path, from which the model will be loaded.
- <strong>custom_objects:</strong> Dictionary for custom objects for compiling (e.g. custom-defined metrics).</p>
<p><strong>Returns:</strong>  None.</p>
<p><strong>Example:</strong>  </p>
<pre><code class="python"># Save fitted model for reusability
model.load(&quot;my_model.hdf5&quot;)
# Predict segmentation of some samples
model.predict(sample_list[100:120])
</code></pre>

<hr />
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Validation/" class="btn btn-neutral float-right" title="Validation Techniques">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Data-Augmentation/" class="btn btn-neutral" title="Data Augmentation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  <p> <a href="/">Home</a> | <a href="/Install/">Installation</a> | <a href="/Usage/">Usage</a> | <a href="/Examples/">Examples</a> | <a href="/Credits/">Contact</a></p>
  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/frankkramer-lab/MIScnn/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../Data-Augmentation/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Validation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script type="text/javascript" defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
