<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Metrics - MISCnn wiki</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">MISCnn wiki</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../Home/">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../Home/">What is MIScnn?</a>
</li>
                                    
<li >
    <a href="../Install/">Install</a>
</li>
                                    
<li >
    <a href="../Usage/">Basic Usage</a>
</li>
                                    
<li >
    <a href="../Tutorials/">Tutorials</a>
</li>
                                    
<li >
    <a href="../Examples/">Examples</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation - Core <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../Data-IO/">Data I/O</a>
</li>
                                    
<li >
    <a href="../Preprocessor/">Preprocessor</a>
</li>
                                    
<li >
    <a href="../Data-Augmentation/">Data Augmentation</a>
</li>
                                    
<li >
    <a href="../Model/">Neural Network Model</a>
</li>
                                    
<li >
    <a href="../Validation/">Validation Techniques</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation - Interfaces <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../Architectures/">Architectures</a>
</li>
                                    
<li class="active">
    <a href="./">Metrics</a>
</li>
                                    
<li >
    <a href="../Subfunctions/">Subfunctions</a>
</li>
                                    
<li >
    <a href="../IO-Interfaces/">I/O Interfaces</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation - Extras <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../Sample/">Sample</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../Contribute/">How to Contribute</a>
</li>
                                    
<li >
    <a href="../Credits/">Author and Contacts</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../Architectures/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../Subfunctions/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#usage-of-loss-functions-and-metrics">Usage of loss functions and metrics</a></li>
        <li class="main "><a href="#available-loss-functions-and-metrics-provided-by-miscnn">Available loss functions and metrics provided by MIScnn</a></li>
            <li><a href="#tversky-loss">Tversky loss</a></li>
            <li><a href="#sum-of-tversky-loss-and-cross-entropy">Sum of Tversky loss and Cross-entropy</a></li>
            <li><a href="#dice-similarity-coefficient-dsc">Dice Similarity Coefficient (DSC)</a></li>
            <li><a href="#soft-dice-similarity-coefficient">Soft Dice Similarity Coefficient</a></li>
            <li><a href="#sum-of-soft-dice-similarity-coefficient-and-cross-entropy">Sum of Soft Dice Similarity Coefficient and Cross-entropy</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>A loss function or metric (or objective function, or optimization score function) is a scoring function to evaluate the current predictive power and performance of a model.</p>
<p>A loss function is required for training and have to be decreasing, if the model performance is increasing. During the training process, the neural network model varies weights of its neurons and tries to optimize the loss function to be as small as possible. A model can only use one loss function.</p>
<p>Metrics are for user evaluation in order to give insights on the training process or the current performance status of the model. It is possible to pass multiple metrics to the model.</p>
<p>MIScnn loss functions and metrics are based on Keras loss/metric functions.<br />
Any loss or metric function defined in Keras, in miscnn.neural_network.metrics or any custom function, which follows the Keras metric guidelines, can be used in MIScnn.</p>
<h2 id="usage-of-loss-functions-and-metrics">Usage of loss functions and metrics</h2>
<p>The loss function and metrics can be defined at the neural network model class initialization.<br />
It is possible to pass the desired loss function with the 'loss' tag and the metrics within a standard python list with the 'metrics' tag.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Import desired loss functions or metrics</span>
<span class="kn">from</span> <span class="nn">miscnn.neural_network.metrics</span> <span class="kn">import</span> <span class="n">tversky_loss</span><span class="p">,</span> <span class="n">dice_soft</span>
<span class="kn">import</span> <span class="nn">keras</span>

<span class="c1"># Add the loss function &amp; metrics to the neural network model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Neural_Network</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span>
                       <span class="n">loss</span><span class="o">=</span><span class="n">tversky_loss</span><span class="p">,</span>
                       <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">dice_soft</span><span class="p">,</span> <span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<p>If no loss or metrics are provided, MIScnn uses the Tversky loss function and no metrics as default.</p>
<h2 id="available-loss-functions-and-metrics-provided-by-miscnn">Available loss functions and metrics provided by MIScnn</h2>
<h4 id="tversky-loss">Tversky loss</h4>
<p>A generalized loss function based on the Tversky index to address the issue of data imbalance and achieve much better trade-off between precision and recall in training 3D fully convo- lutional deep neural networks.<br />
Reference: <a href="https://arxiv.org/abs/1706.05721">https://arxiv.org/abs/1706.05721</a></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">miscnn.neural_network.metrics</span> <span class="kn">import</span> <span class="n">tversky_loss</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Neural_Network</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">tversky_loss</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="sum-of-tversky-loss-and-cross-entropy">Sum of Tversky loss and Cross-entropy</h4>
<p>Based on the idea of Fabian Isensee et al. for using the sum of the Dice Similarity Coefficient and the Cross-Entropy, MIScnn implemented a loss function based on the sum of the Tversky loss &amp; Cross-Entropy loss function.<br />
Reference Fabian Isensee et al: <a href="http://arxiv.org/abs/1809.10486">http://arxiv.org/abs/1809.10486</a></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">miscnn.neural_network.metrics</span> <span class="kn">import</span> <span class="n">tversky_crossentropy</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Neural_Network</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">tversky_crossentropy</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="dice-similarity-coefficient-dsc">Dice Similarity Coefficient (DSC)</h4>
<p>The Dice Similarity Coefficient is one the most popular loss functions for training deep learning models in medical image segmentation. It has the ability the handle strong class imbalance which is common in medical imaging. The standard Dice Similarity Coefficient is suited for binary medical image segmentation problems.<br />
Reference: -&gt;  add wikipedia link</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">miscnn.neural_network.metrics</span> <span class="kn">import</span> <span class="n">dice_coefficient_loss</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Neural_Network</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">dice_coefficient_loss</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="soft-dice-similarity-coefficient">Soft Dice Similarity Coefficient</h4>
<p>The Soft Dice Similarity Coefficient is an extension of the standard Dice Similarity Coeffcient. The only difference is, that the soft DSC is normalized on the number of classes. Therefore, the soft Dice Similarity Coefficient is more suited for multi-class (&gt;2 classes) medical image segmentation problems.<br />
Reference: -&gt;  add wikipedia link</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">miscnn.neural_network.metrics</span> <span class="kn">import</span> <span class="n">dice_soft_loss</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Neural_Network</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">dice_soft_loss</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr />
<h4 id="sum-of-soft-dice-similarity-coefficient-and-cross-entropy">Sum of Soft Dice Similarity Coefficient and Cross-entropy</h4>
<p>In diverse medical image segmentation challenges, the winner Fabian Isensee et al. is always using the sum of the soft Dice Similarity Coeffcient and the Cross-Entropy in order to achieve the best performance. Additionally, Fabian Isensee et al. also uses this loss function in his powerful software nnUnet.<br />
Reference: <a href="http://arxiv.org/abs/1809.10486">http://arxiv.org/abs/1809.10486</a></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">miscnn.neural_network.metrics</span> <span class="kn">import</span> <span class="n">dice_crossentropy</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Neural_Network</span><span class="p">(</span><span class="n">preprocessor</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">dice_crossentropy</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<hr /></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
